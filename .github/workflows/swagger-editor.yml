name: Swagger Editor

'on':

  push:

    branches:

      - '**'

  pull_request:

    branches:

      - '**'

  schedule:

    - cron: 0 1 * * *

  workflow_dispatch: null

jobs:

  validate:

    runs-on: ubuntu-latest

    steps:

      - name: Checkout

        uses: actions/checkout@v3
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '16'
      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y libatk1.0-0 libatk-bridge2.0-0 libxss1 libnss3 libasound2
          npm install

      - name: Run Puppeteer tests
        run: |
          node -e "const puppeteer = require('puppeteer'); (async () => {
          const browser = await puppeteer.launch({
            args: ['--no-sandbox', '--disable-setuid-sandbox']
          });
          const page = await browser.newPage();
          await page.goto('https://example.com');
          console.log(await page.title());
          await browser.close();
          })();"
      - name: Validate OpenAPI definition

        uses: char0n/swagger-editor-validate@v1.3.2

        with:

          definition-file: openbanking-us.yaml
